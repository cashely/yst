<!DOCTYPE HTML>
<html>
  <head>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,minimal-ui" />
    <meta charset="utf-8" />
    <meta name="x5-fullscreen" content="true">
    <meta name="full-screen" content="yes">
    <title>广州 阿莫克拉 口服</title>
    <link href="../lib/light7/css/light7.min.css" rel="stylesheet" />
    <link href="../lib/fontAw/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../dist/css/all.css" rel="stylesheet" />
  </head>
  <body>
    <div class="page">
      <!-- 头部筛选 start -->
      <header class="bar bar-nav select-header">
        <div class="searchbar">
          <a class="searchbar-cancel" onclick="actionSearchHospital()">确定</a>
          <div class="search-input">
            <label class="icon icon-search" for="search"></label>
            <input type="search" id='search' placeholder='请输入品种关键字...'/>
          </div>
        </div>
      </header>
      <!-- 头部筛选 end -->
      <!-- 二级菜单 start -->
      <div class="bar bar-header-secondary select-header-secondary">
        <div class="optional-header row no-gutter table-row-header no-edit">
          <div class="col-2-tym">医院</div>
        </div>
      </div>
      <!-- 二级菜单 end -->
      <div class="content" data-distance="100">
        <div class="center">
          <div class="list-block item-pean-horizontal">
            <ul class="table-row" id="searchUserBreedHospitalInfo">
            </ul>
          </div>
        </div>
      </div>
    </div>
    <!-- <script src="dist/js/jquery.min.js"></script> -->
    <script type="text/javascript" src="../src/js/jweixin-1.0.0.js"></script>
    <script src="http://www.light7.cn/assets/js/zepto.js"></script>
    <script src="../lib/light7/js/light7.js"></script>
    <script type="text/javascript" src="../lib/light7/js/light7-city-picker.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="../src/js/common.js"></script>
    <script type="text/javascript" src="../src/js/data.api.js"></script>
    <script src="../src/js/all.js"></script>
    <script type="text/javascript">
      $('.infinite-scroll-preloader').remove();
      function actionSearchHospital(){
        $('#searchUserBreedHospitalInfo').empty();
        var loading = false;
          dataApi.reSet();
          var keywords = $('#search').val();
         $.attachInfiniteScroll('.infinite-scroll');
         dataApi.searchUserBreedHospitalInfo(keywords,function(data,totalNum){
            renderDom(data);
            if($('#searchUserBreedHospitalInfo li').length >= totalNum){
              $.detachInfiniteScroll($('.infinite-scroll'));
              $('.infinite-scroll-preloader').remove();
            }
          });
         $(document).on('infinite', '.infinite-scroll',function() {
            if (loading) return;
            loading = true;
            dataApi.searchUserBreedHospitalInfo(keywords,function(data,totalNum){
              renderDom(data); 
              if($('#searchUserBreedHospitalInfo li').length >= totalNum){
                $.detachInfiniteScroll($('.infinite-scroll'));
                $('.infinite-scroll-preloader').remove();
              }
              loading = false;
            });
         });
      }


      function renderDom(data){
        var str = '';
        $.each(data, function() {
            str += '<li class="item-content" data-id="' + url2obj(location.search).bId + '" data-aid = "' + url2obj(location.search).aId + '" data-hid="'+this.id+'"><div class="item-inner">';
            str += '<div class="col-2-tym">'+this.hospitalName+'('+this.hospitalShortName+')<i class="bradge no-bg">'+translateIcoType(this.icoType)+'</i></div>';
            str += '<div class="add ' + (this.isOpt !== 0 ? 'hidden' : '') + '" onClick="addHosAction(this)"><i class="fa fa-plus-circle fa-lg"></i></div>';
                    str += '<div class="add ' + (this.isOpt === 0 ? 'hidden' : '') + '"><i class="fa fa-check-circle fa-lg"></i></div>';
            str += '</div></li>';
        })
        $(str).appendTo($('#searchUserBreedHospitalInfo'));
      }
    </script>
  </body>
</html>