<!DOCTYPE HTML>
<html lang="zh_cn">
    <head>
        <meta content="width=device-width,initial-scale=1,user-scalable=no,minimal-ui" name="viewport"/>
        <meta charset="utf-8"/>
        <meta content="true" name="x5-fullscreen">
            <meta content="yes" name="full-screen">
            <meta http-equiv="pragma" content="no-cache">
                <title>
                    分类涨幅榜
                </title>
                <link href="../lib/light7/css/light7.min.css" rel="stylesheet"/>
                <link href="../lib/fontAw/css/font-awesome.min.css" rel="stylesheet"/>
                <link href="../dist/css/all.css" rel="stylesheet"/>
            </meta>
        </meta>
    </head>
    <body>
        <div class="page">
            <!-- 头部菜单 start -->
            <header class="bar bar-nav">
                <div class="button button-link button-nav pull-left city-block">
                    <i class="fa fa-map-marker fa-lg">
                    </i>
                    <input class="open-panel" data-panel="#panel-left" id="privice" readonly="" type="button" value="深圳"/>
                </div>
                <h1 class="title">
                    <div class="calendar-header">
                        <i class="fa fa-calendar">
                        </i>
                        <input class="date-input" id="my-input" type="button"/>
                    </div>
                </h1>
            </header>
            <!-- 头部菜单 end -->
            <!-- 二级菜单 start -->
            <div class="bar bar-header-secondary">
                <div class="optional-header row no-gutter table-row-header no-edit">
                    <div class="col-5-tym no-add">
                        一级分类
                    </div>
                    <div class="col-4-scgm sort" data-sortName='sales'>
                        市场规模
                    </div>
                    <div class="col-4-scfe sort" data-sortName='marketMth'>
                        市场份额
                    </div>
                    <div class="col-4-zdf sort"  data-sortName='change'>
                        涨跌幅
                    </div>
                    <div class="col-4-ev sort" data-sortName='ev'>
                        EV
                    </div>
                </div>
            </div>
            <!-- 二级菜单 end -->
            <div class="content has-secondary-bar infinite-scroll" data-distance="100">
                <div class="center">
                    <div class="list-block item-pean-horizontal">
                        <ul class="table-row" id="businessSalesInfo">
                        </ul>
                    </div>
                    <!-- 下拉无限滚动 -->
                    <div class="infinite-scroll-preloader">
                        <div class="preloader">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 省份列表 -->
        <div class="panel-overlay">
        </div>
        <!-- Left Panel with Reveal effect -->
        <div class="panel panel-left panel-reveal theme-dark" id="panel-left">
        </div>
        <!-- <script src="dist/js/jquery.min.js"></script> -->
        <script src="../src/js/jweixin-1.0.0.js" type="text/javascript">
        </script>
        <script src="http://www.light7.cn/assets/js/zepto.js">
        </script>
        <script src="../lib/light7/js/light7.min.js">
        </script>
        <script src="../src/js/common.js" type="text/javascript">
        </script>
        <script charset="utf-8" src="../lib/light7/js/light7-city-picker.min.js" type="text/javascript">
        </script>
        <script src="../src/js/data.api.js" type="text/javascript">
        </script>
        <script src="../src/js/all.js">
        </script>
        <script type="text/javascript">
            var loading = false;
             $.attachInfiniteScroll('.infinite-scroll');
             $(document).on('infinite', '.infinite-scroll',function() {
                if (loading) return;
                dataApi.getRiseData(function(data,total){
                  renderDom(data,total);
                },{
                    sidx:$('.table-row-header').data('sidx'),
                    sord:$('.table-row-header').data('sord')
                });
             });

             $('.infinite-scroll').trigger('infinite');

            $(document).on('click','.sort',function(event){
              $('#businessSalesInfo li').remove();
              sortFn(event.target);
              $('.infinite-scroll').trigger('infinite');
            });

             function renderDom(data,total){
                var str = '';
                loading = true;
                $.each(data, function() {
                    str += '<li class="item-content no-edit">';
                    if(url2obj(location.search).AP == "getBusinessSalesInfo"){
                        str += '<a href="optional.html?id=' + this.id + '&areaId=' + this.areaId + '&pName=' + url2obj(location.search).pName + '&sId=' + this.salesId + '&time=' + url2obj(location.search).time + '&AP=getSalesBreedInfo&title=' + this.salesName  + '" class="external item-inner item-link">';
                    }else{
                        str += '<a href="optional.html?id=' + this.id + '&areaId=' + this.areaId + '&pName=' + url2obj(location.search).pName + '&sId=' + this.conceptId + '&time=' + url2obj(location.search).time + '&AP=getConceptBreedInfo&title=' + this.conceptName   + '" class="external item-inner item-link">';
                    }
                    str += '<div class="col-5-tym no-add"><span>';
                    if(url2obj(location.search).AP != "getBusinessConceptInfo"){
                        str += '<i class="bradge inline">'+ translateIcoType(this.icoType) +'</i>';
                    }
                    str += (this.salesName || this.conceptName) + '</span></div>';
                    str += '<div class="col-4-scgm">' + this.sales + '万</div>';
                    if(this.marketMth >= 0){
                        str += '<div class="col-4-scfe z">' + this.marketMth + '%</div>';
                    }else{
                        str += '<div class="col-4-scfe d">' + this.marketMth + '%</div>';
                    }
                    if (this.change >= 0) {
                        str += '<div class="col-4-zdf z">' + this.change + '%</div>';
                    } else {
                        str += '<div class="col-4-zdf d"> ' + this.change + '%</div>';
                    }
                    if(this.ev >= 0){
                        str += '<div class="col-4-zdf z">' + this.ev + '</div>';
                    }else{
                        str += '<div class="col-4-zdf d">' + this.ev + '</div>';
                    }
                    str += '</a></li>';
                })
                $(str).appendTo($('#businessSalesInfo'));
                loading = false;
                if($('#businessSalesInfo li').length >= total){
                    $.detachInfiniteScroll($('.infinite-scroll'));
                    $('.infinite-scroll-preloader').remove();
                 }
            }
        </script>
    </body>
</html>
